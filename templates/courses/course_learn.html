{% extends 'base.html' %}

{% block title %}{{ current_lesson.title }} - {{ course.title }} - BackendMaster{% endblock %}

{% block content %}
  <h1>{{ course.title }}: {{ current_lesson.title }}</h1>

  <div class="row">
    <div class="col-md-6">
      <h3>Материалы урока</h3>
      <div>{{ current_lesson.content|safe }}</div>
      {% if current_lesson.video %}
        <p><strong>Видео:</strong> <a href="{{ current_lesson.video }}" target="_blank">{{ current_lesson.video }}</a></p>
      {% endif %}
      {% if current_lesson not in enrollment.completed_lessons.all %}
        <a href="{% url 'courses:course_learn' course.pk %}?lesson_id={{ current_lesson.id }}&mark_completed=1" class="btn btn-success mt-3">Отметить как пройденный</a>
      {% else %}
        <p class="text-success mt-3">Этот урок уже пройден!</p>
      {% endif %}
    </div>

    <div class="col-md-6">
      <h3>Задание для практики</h3>
      <p>Напишите HTML-код, который создаёт страницу с заголовком и абзацем текста.</p>

      <h4>Редактор</h4>
      <textarea class="form-control" rows="10" placeholder="Введите ваш код здесь..."></textarea>
      <button class="btn btn-primary mt-2">Запустить</button>
      <button class="btn btn-secondary mt-2">Сбросить</button>

      <h4>Результат</h4>
      <div class="border p-3" style="min-height: 100px;">

      </div>
    </div>
  </div>

  <div class="mt-4">
    <h4>Уроки курса</h4>
    <ul class="list-group">
      {% for lesson in lessons %}
        <li class="list-group-item {% if lesson == current_lesson %}active{% endif %}">
          <a href="{% url 'courses:course_learn' course.pk %}?lesson_id={{ lesson.id }}">{{ lesson.title }}</a>
          {% if lesson in enrollment.completed_lessons.all %}
            <span class="badge bg-success ms-2">Пройден</span>
          {% endif %}
        </li>
      {% endfor %}
    </ul>

    <div class="mt-3">
      {% if previous_lesson_id %}
        <a href="{% url 'courses:course_learn' course.pk %}?lesson_id={{ previous_lesson_id }}" class="btn btn-primary">Предыдущий урок</a>
      {% endif %}
      {% if next_lesson_id %}
        <a href="{% url 'courses:course_learn' course.pk %}?lesson_id={{ next_lesson_id }}" class="btn btn-primary">Следующий урок</a>
      {% else %}
        <a href="{% url 'courses:course_detail' course.pk %}" class="btn btn-success">Завершить курс</a>
      {% endif %}
    </div>
  </div>
{% endblock %}